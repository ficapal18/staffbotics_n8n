[
  {
    "updatedAt": "2025-11-26T18:25:16.825Z",
    "createdAt": "2025-11-26T18:25:16.825Z",
    "id": "aCgdPWq5doFaISwL",
    "name": "Staffbotics Patient Grouping (MVP with src modules)",
    "description": null,
    "active": false,
    "isArchived": false,
    "nodes": [
      {
        "parameters": {
          "httpMethod": "POST",
          "path": "staffbotics-batch",
          "responseMode": "lastNode",
          "options": {}
        },
        "id": "ca047524-441a-4e21-a09c-14bca8b4f80c",
        "name": "Receive Batch (Webhook)",
        "type": "n8n-nodes-base.webhook",
        "position": [
          -64,
          -128
        ],
        "typeVersion": 2.1,
        "webhookId": "b2e18edf-67ec-4b79-be5c-d26d8a63d678"
      },
      {
        "parameters": {
          "functionCode": "const { buildRawItemsFromWebhookBody } = require('/data/src/rawItems');\n\nconst body = $input.first().json || {};\nconst { rawItems, originalBody } = buildRawItemsFromWebhookBody(body);\n\nreturn [{ json: { rawItems, originalBody } }];"
        },
        "id": "4cae35fe-209b-4ad8-81d1-e486bb645237",
        "name": "Build RawItems",
        "type": "n8n-nodes-base.function",
        "position": [
          304,
          -128
        ],
        "typeVersion": 1
      },
      {
        "parameters": {
          "functionCode": "const { buildHeuristicAnalysis } = require('/data/src/heuristics');\n\nconst { rawItems, originalBody } = $input.first().json;\nconst { analysisText } = buildHeuristicAnalysis(originalBody);\n\nreturn [{ json: { rawItems, originalBody, analysisText } }];"
        },
        "id": "653d9f49-2a2d-407f-b48c-7d23f281685d",
        "name": "Heuristic Analysis",
        "type": "n8n-nodes-base.function",
        "position": [
          656,
          -128
        ],
        "typeVersion": 1
      },
      {
        "parameters": {
          "method": "POST",
          "url": "https://api.openai.com/v1/chat/completions",
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {}
            ]
          },
          "options": {}
        },
        "id": "e10b0bfc-0d7b-49d5-95db-02c763dd8d83",
        "name": "Structure Advisor (LLM)",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          1040,
          -128
        ],
        "typeVersion": 4.3
      },
      {
        "parameters": {
          "functionCode": "let config = {};\nlet raw = items[0].json;\ntry {\n  config = JSON.parse(raw.choices[0].message.content);\n} catch (e) {\n  config = { unit_strategy: 'excel_row', excel: { row_is_patient: true }, folder: { use_subfolders_as_patients: false } };\n}\n\nreturn [{ json: { rawItems: $items(0,0).json.rawItems, originalBody: $items(0,0).json.originalBody, analysisText: $items(0,0).json.analysisText, groupingConfig: config } }];"
        },
        "id": "d4486397-f4b3-44a8-9714-37c78b284680",
        "name": "Parse LLM Config",
        "type": "n8n-nodes-base.function",
        "position": [
          1408,
          -128
        ],
        "typeVersion": 1
      },
      {
        "parameters": {
          "functionCode": "const { autoGroup } = require('/data/src/grouping');\n\nconst { rawItems, groupingConfig, analysisText } = $input.first().json;\nconst result = autoGroup(rawItems, groupingConfig, analysisText);\nreturn [{ json: result }];"
        },
        "id": "32607d6f-2d6e-4bf1-a38c-13b40834549f",
        "name": "Auto Grouping",
        "type": "n8n-nodes-base.function",
        "position": [
          1760,
          -128
        ],
        "typeVersion": 1
      },
      {
        "parameters": {
          "functionCode": "const { summarizeProposal } = require('/data/src/summary');\n\nconst { patientCandidates, groupingConfig, analysisText } = $input.first().json;\nconst { summary } = summarizeProposal(patientCandidates, groupingConfig, analysisText);\nreturn [{ json: { summary, groupingConfig, patientCandidates } }];"
        },
        "id": "b0486c40-ffd6-4be7-b1ee-d2797ebff64a",
        "name": "Summarize Proposal",
        "type": "n8n-nodes-base.function",
        "position": [
          2128,
          -128
        ],
        "typeVersion": 1
      },
      {
        "parameters": {
          "httpMethod": "POST",
          "path": "staffbotics-reorg",
          "responseMode": "lastNode",
          "options": {}
        },
        "id": "a2675ad9-555c-46e4-b931-c3fab300e7da",
        "name": "Apply Reorg (Webhook)",
        "type": "n8n-nodes-base.webhook",
        "position": [
          -64,
          336
        ],
        "typeVersion": 2.1,
        "webhookId": "792a2f6d-f841-4d15-b66a-ef340c515f01"
      },
      {
        "parameters": {
          "method": "POST",
          "url": "https://api.openai.com/v1/chat/completions",
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {}
            ]
          },
          "options": {}
        },
        "id": "eb2f1747-29bb-486d-a13c-d5892774ac77",
        "name": "NL â†’ Operations (LLM)",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          304,
          336
        ],
        "typeVersion": 4.3
      },
      {
        "parameters": {
          "functionCode": "const { applyOperations } = require('/data/src/operations');\n\nlet content;\ntry { content = JSON.parse(items[0].json.choices[0].message.content); } catch (e) { content = []; }\n\nconst original = $items(0, 0).json;\nconst result = applyOperations(original.patientCandidates, content, original.userInstruction);\nreturn [{ json: result }];"
        },
        "id": "c5309720-10fc-4596-8a34-b2446e63d4a8",
        "name": "Apply Operations",
        "type": "n8n-nodes-base.function",
        "position": [
          656,
          336
        ],
        "typeVersion": 1
      }
    ],
    "connections": {},
    "settings": {
      "executionOrder": "v1"
    },
    "staticData": null,
    "meta": null,
    "pinData": {},
    "versionId": "3845a76b-1296-411c-b820-8f33312548e6",
    "versionCounter": 5,
    "triggerCount": 0,
    "tags": [],
    "shared": [
      {
        "updatedAt": "2025-11-26T18:25:16.825Z",
        "createdAt": "2025-11-26T18:25:16.825Z",
        "role": "workflow:owner",
        "workflowId": "aCgdPWq5doFaISwL",
        "projectId": "WPiW6V1ZSDaOxRU6",
        "project": {
          "updatedAt": "2025-11-26T17:37:25.333Z",
          "createdAt": "2025-11-26T17:33:26.070Z",
          "id": "WPiW6V1ZSDaOxRU6",
          "name": "Joan FV <ficapal18@gmail.com>",
          "type": "personal",
          "icon": null,
          "description": null
        }
      }
    ]
  }
]